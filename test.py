import re
from bs4 import BeautifulSoup

def extract_email_data(email_body):
    # Define regex patterns for each required field
    patterns = {
        "Marken_reference": r"Marken reference:\s*(\S+)",
        "Number": r"Number:\s*(\d+)",
        "Weight": r"Weight:\s*(\d+\s*kg)",
        "Location": r"Location:\s*(\S+)",
        "HS_code": r"HS code:\s*(\d+)",
        "EORI": r"EORI:\s*(?:.*?)([A-Z]{2}\d{10})",  # Adjusted pattern for EORI
        "Depart_from": r"Depart from BRU - (\S+)"
    }

    # Initialize a dictionary to store the extracted values
    extracted_data = {}

    # Extract values using regex
    for key, pattern in patterns.items():
        match = re.search(pattern, email_body)
        if match:
            extracted_data[key] = match.group(1)

    return extracted_data

def extract_and_clean(html_content):
    soup = BeautifulSoup(html_content, 'html.parser')
    data = soup.get_text()
    
    return data

# Sample email body
email_body = """<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><meta name="Generator" content="Microsoft Word 15 (filtered medium)"><style><!-- /* Font Definitions */@font-face{font-family:Wingdings;panose-1:5 0 0 0 0 0 0 0 0 0;}@font-face{font-family:"Cambria Math";panose-1:2 4 5 3 5 4 6 3 2 4;}@font-face{font-family:Calibri;panose-1:2 15 5 2 2 2 4 3 2 4;}/* Style Definitions */p.MsoNormal, li.MsoNormal, div.MsoNormal{margin:0cm;font-size:11.0pt;font-family:"Calibri",sans-serif;}span.EmailStyle17{mso-style-type:personal-compose;font-family:"Arial",sans-serif;color:black;font-weight:normal;font-style:normal;text-decoration:none none;}.MsoChpDefault{mso-style-type:export-only;mso-fareast-language:EN-US;}@page WordSection1{size:612.0pt 792.0pt;margin:70.85pt 70.85pt 70.85pt 70.85pt;}div.WordSection1{page:WordSection1;}--></style><!--[if gte mso 9]><xml><o:shapedefaults v:ext="edit" spidmax="1026" /></xml><![endif]--><!--[if gte mso 9]><xml><o:shapelayout v:ext="edit"><o:idmap v:ext="edit" data="1" /></o:shapelayout></xml><![endif]--></head><body lang="NL-BE" link="#0563C1" vlink="#954F72" style="word-wrap:break-word"><div class="WordSection1"><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Hi Kasia,</span><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Please find attached an order CH ex Bornem with shipping invoice for tomorrow 20/11.</span><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><a href="mailto:export@dkm-customs.com" target="_blank"><span style="text-decoration:none">@export@dkm-customs.com</span></a>,</span><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Please find documents attached and help with export customs clearance.</span><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Customs exit gate:</span><b><span lang="EN-US">Saint Louis FR004050</span></b><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">&nbsp;</span><span lang="EN-US"><o:p></o:p></span></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">BR</span><o:p></o:p></p><p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Christian</span><o:p></o:p></p><p class="MsoNormal"><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><o:p>&nbsp;</o:p></span></p><div id="email-signature-manager-signature"><div><div><div><p class="MsoNormal"><b><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#ED7D31;mso-fareast-language:NL-BE">Met vriendelijke groeten, Best regards, Cordialement,<span style="mso-ligatures:none"><o:p></o:p></span></span></b></p><p class="MsoNormal" style="margin-bottom:12.0pt"><b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#00B0F0;mso-fareast-language:NL-BE">Christian&nbsp;Tchoffo 
Tchinda</span></b><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:NL-BE"><br></span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#E9713A;mso-fareast-language:NL-BE">Logistics Specialist</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:NL-BE"><br><br></span><b><span lang="EN-US" style="font-size:12.0pt;color:#005496;mso-fareast-language:NL-BE">Made better.</span></b><b><span style="font-size:12.0pt;color:#005496;mso-fareast-language:NL-BE">By science.&#8482;</span></b><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:NL-BE"><o:p></o:p></span></p><table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse"><tbody><tr><td width="18" style="width:13.5pt;padding:.75pt .75pt .75pt .75pt"><p class="MsoNormal"><b><span style="font-size:10.0pt;color:#005496;mso-fareast-language:NL-BE">E</span></b><span style="color:black;mso-fareast-language:NL-BE"><o:p></o:p></span></p></td><td style="padding:.75pt .75pt .75pt .75pt"><p class="MsoNormal"><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#ED7D31;mso-fareast-language:NL-BE"><a href="mailto:christian.tchoffotchinda@lonza.com"><span lang="EN-US" style="color:#ED7D31">christian.tchoffotchinda@lonza.com</span></a></span><span style="color:black;mso-fareast-language:NL-BE"><o:p></o:p></span></p></td></tr></tbody></table><p class="MsoNormal"><span style="color:black;mso-fareast-language:NL-BE"><br></span><a href="http://www.lonza.com/"><span style="color:blue;mso-fareast-language:NL-BE;text-decoration:none"><img border="0" width="164" height="75" style="width:1.7083in;height:.7812in" id="Picture_x0020_1" src="[_{{{CITATION{{{_1{](https://github.com/CindySalinas/padawan-javascript/tree/6a11dc0e008d5b497ddf07df54df8b527a106519/static%2Fmails.js)[_{{{CITATION{{{_2{](https://github.com/lukeschafer/HtmlCleanser/tree/1c6b25713ebf81c9129527660bd135ed9200fbec/src%2FHtmlCleanser.Tests%2FHtmlCleanserTests.cs)[_{{{CITATION{{{_3{](https://github.com/KingJing01/cgzb/tree/f23ae79a95fd8c9170a7a62861f4bd3205966839/grid_cg_sjshlc%2Fgrid_cg_sjshlc_grid.class.php)[_{{{CITATION{{{_4{](https://github.com/Jawhar10sai/Project/tree/33f43c550d4b150f90e5930a283f260870d91c10/lve%2FwsReclamation%2Freclamation_envoiCopy.php)[_{{{CITATION{{{_5{](https://github.com/edward1986/diagold/tree/4cf696ceb9d1a2d32d975fbff9ff0d4a220c4b8d/public%2F5.js)[_{{{CITATION{{{_6{](https://github.com/sakshipatel-515/project_resume/tree/adb7f38a55dfd17ab5b9ecf822f6479fd74d2821/output%2Fresume5.php)[_{{{CITATION{{{_7{](https://github.com/Korakbhakta02/Resume_Creator/tree/4d60eb7d97bbbd1f73f3ee72ce220f3fc7edae3e/output%2Fresume4.php)[_{{{CITATION{{{_8{](https://github.com/avirdee0720/clockingpage/tree/92d89eb720a7c4fc68540ba0c952ffdc09631320/web%2Forgmve%2Fhrpicturelist.php)[_{{{CITATION{{{_9{](https://github.com/arakdraja/modin/tree/f81d43716dfa50f4782097502142e08f2fe4aba1/application%2Fviews%2Fdokumen%2Fvmodin_skk3.php)[_{{{CITATION{{{_10{](https://github.com/PhiHuyHoang/Class-schedule-Reminder/tree/3462418d0350036a8a301b701a5713c92de42f0c/Handle_Script.py)[_{{{CITATION{{{_11{](https://github.com/krisplanckaert/owh/tree/b2d19164d45be44b456281686588683a1e49f364/library%2FBvb%2FGrid%2FTemplate%2FWord.php)[_{{{CITATION{{{_12{](https://github.com/robertokovalev/robertokovalev.github.io/tree/a0595b6cd4a16aede7ccd424b9dbe81d066f505b/vision.hyperesources%2Fvision_hype_generated_script.js)[2024-11-20T17:15:16.989Z] Executed 'Functions.marken' (Succeeded, Id=0276e7ab-03a4-4d59-9da9-dc2aeceeca6e, Duration=3109ms)"""

# Extract data from the email body
extracted_data = extract_and_clean(email_body)
extracted_data = extract_email_data(extracted_data)

print(extracted_data)